{% extends 'Juegos-Multimedia/base.html' %}
{% load static %}

{% block title %}Introducción{% endblock %}


<!-- Custom block content -->
{% block content %}
    <form action="/500/multimedia/to_game/" method="POST" id="form_Gen_SesionJuegoForm_id">
        {% csrf_token %}
        <div class="wrapper">
            <div class="square_intro">
                <div id="qrcode"></div>
                <div class="btnSound"><i class="fas fa-volume-up"></i></div>
                <div class="title">Introducción</div>
                <p>{{ intro }}</p>
                <button type="submit" class="btnContinue" id="btnCode">Continuar</button>

            </div>
        </div>
    </form>
{% endblock %}



<!-- Custom block for javascript -->
{% block js_script %}

    <script>
        let qr_code = '{{ qr_code }}';

        if (qr_code !== '')
            new QRCode(document.getElementById("qrcode"), qr_code);
        $(document).ready(function() {
            $("form#form_Gen_SesionJuegoForm_id").submit(function (e) {
                e.preventDefault();
                let url_ = $(this).attr('action');
                let fields = new FormData(this);
                fields.append('code', '{{ code }}');
                fields.append('name', '{{ name }}');
                sendToServer(url = url_, data = fields, method = 'POST')
                    .then(data => {
                        if (data.message !== "ok") {
                            shakeAndTurnRed('.inputText')
                            showError(data.message,2.5, '#F2676C');
                            return
                        }
                        window.location.href = data.url;
                    })
            });
        });
    </script>
{% endblock %}
